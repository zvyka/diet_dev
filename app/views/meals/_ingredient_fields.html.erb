<p class="fields">
	<%= f.label :what_food, "Food" %><br />
	<%= f.text_field :what_food %>
	<%= f.hidden_field :food_id %>
	<%= f.label :servings, "How many servings?" %>
	<%= f.text_field :servings %>
	<label id="serving_size"></label>
	<%= f.link_to_remove "remove" %>
	<script type="text/javascript">
	$(document).ready(function() {
	    $('*[id*=what_food]').autocomplete({ source: '<%= foods_path(:format => :json) %>',
						focus: function(event, ui) {
						           $(this).next().next().next().next().text(ui.item ? ui.item.serving : "100 grams");
						           if (ui.item) {
						               $(this).next().next().next().next().text("One serving is: " + ui.item.serving
						 																												+	" (" + ui.item.grams + " grams)");
														$(this).next().val(ui.item.food_id);
						           }
											if (!ui.item.serving){
												$(this).next().next().next().next().text("100 grams");
											}
						       }
						}
			 );
	
	$.ui.autocomplete.prototype._renderItem = function (ul, item) {
							the_term = this.term.split(' ').join('|');
	            item.label = item.label.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + the_term + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<strong>$1</strong></strong>");
	            return $("<li></li>")
	                    .data("item.autocomplete", item)
	                    .append("<a>" + item.label + "</a>")
	                    .appendTo(ul);
	        };
	
	});
	</script>
</p>